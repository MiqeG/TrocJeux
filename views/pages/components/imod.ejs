<form class="ui form asd iform hiddeniformdiv" id="imod" action="/upduserinfo" method="POST">


    <input type="hidden" name="_csrf" value="<%= csrfToken %>">


    <div class="two fields">
        <div class="field">
            <label class="whiteclasstitle" for="NomUitilisateur"> <i class="user teal icon"></i>Nom
                d'utilisateur</label>
            <% if(locals.formdata && locals.formdata.NomUitilisateur && locals.flash.code!="nUdejaSoumis"){ %>

            <input class="disabled field" name="NomUitilisateur" id="NomUitilisateur"
                value="<%= locals.formdata.NomUitilisateur %>" maxlength="20" minlength="4" autocomplete="off"
                readonly="readonly"></input>
            <% }else{ %>

            <input class="disabled field" name="NomUitilisateur" id="NomUitilisateur" maxlength="20" minlength="4"
                autocomplete="off" readonly="readonly"></input>
            <% } %>
        </div>
        <div class="field">
            <label class="whiteclasstitle" for="Nom"><i class="address card teal icon"></i> Nom</label>
            <% if(locals.formdata && locals.formdata.Nom){ %>
            <input class="disabled field" name="Nom" id="Nom" value="<%= locals.formdata.Nom %>" maxlength="35"
                minlength="2" autocomplete="off" readonly="readonly"></input>
            <% }else{ %>
            <input class="disabled field" name="Nom" id="Nom" maxlength="35" minlength="2" autocomplete="off"
                readonly="readonly"></input>
            <% } %>

        </div>
    </div>
    <div class="two fields">
        <div class="field">

            <label class="whiteclasstitle" for="Prenom"><i class="address card outline teal icon"></i>
                Prenom</label>
            <% if(locals.formdata && locals.formdata.Prenom ){ %>
            <input class="disabled field" name="Prenom" id="Prenom" value="<%= locals.formdata.Prenom %>" maxlength="35"
                minlength="2" autocomplete="off" readonly="readonly"></input>
            <% }else{ %>
            <input class="disabled field" name="Prenom" id="Prenom" maxlength="35" minlength="2" autocomplete="off"
                readonly="readonly"></input>
            <% } %>
        </div>
        <div class="field">

            <label class="whiteclasstitle" for="Email"><i class="envelope open outline teal icon"></i>Email</label>
            <% if(locals.formdata && locals.formdata.Email && locals.flash.code!="eDejaSoumis"){ %>
            <input class="disabled field" name="Email" id="Email" value="<%= locals.formdata.Email %>" maxlength="50"
                autocomplete="off" readonly="readonly"></input>
            <% }else{ %>
            <input class="disabled field" name="Email" id="Email" maxlength="50" autocomplete="off"
                readonly="readonly"></input>
            <% } %>
        </div>
    </div>

    <div class="two fields">
        <div class="field">
            <label class="whiteclasstitle" for="MotDePasse"><i class="key icon teal"></i> Mot de passe</label>
            <% if(locals.formdata && locals.formdata.MotDePasse ){ %>
            <input class="changer" name="MotDePasse" id="MotDePasse" type="password"
                value="<%= locals.formdata.MotDePasse %>" maxlength="40" autocomplete="off"></input>
            <% }else{ %>
            <input class="changer" name="MotDePasse" id="MotDePasse" type="password" maxlength="40"
                autocomplete="off"></input>
            <% } %>
        </div>
        <div class="field">
            <label class="whiteclasstitle" for="MotDePasse"><i class="keyboard outline teal icon"></i> Verification
                mot
                de passe</label>
            <input class="changer" name="VerificationMotDePasse" id="VerificationMotDePasse" type="password"
                maxlength="40" autocomplete="off"></input>
        </div>
    </div>
    <div class="two fields">
        <div class="field">
            <label class="whiteclasstitle" for=" Adresse"><i class="address card teal icon"></i> Adresse</label>
            <% if(locals.formdata && locals.formdata.Adresse ){ %>
            <input class="changer" name="Adresse" id="Adresse" value="<%= locals.formdata.Adresse %>" maxlength="400"
                minlength="4"></input>
            <% }else{ %>
            <input class="changer" name="Adresse" id="Adresse" maxlength="400" minlength="4"></input>
            <% } %>
        </div>
        <div class="field">
            <label class="whiteclasstitle"><i class="globe teal icon"></i> Pays</label>
            <div class="ui fluid selection dropdown">
                <% if(locals.formdata &&locals.formdata.Pays  ){ %>
                <input class="changer" type="hidden" name="Pays" id="Pays" value="<%= locals.formdata.Pays %>">
                <% }else{ %>
                <input class="changer" type="hidden" name="Pays" id="Pays">
                <% } %>
                <% if(locals.formdata &&locals.formdata.Pays  ){ %>
                <div class="default text  " style="color:black" id="PaysTexte"><%= locals.formdata.Pays  %></div>
                <% }else{ %>
                <div class="default text" style="color:black">-</div>
                <% } %>
                <i class="dropdown icon"></i>
                <div class="inverted menu">
                    <div id="PaysValue" class="item" data-value="France">France</div>

                </div>
            </div>
        </div>

    </div>
    <div class="two fields">
        <div class="field unhide" hidden>
            <label class="whiteclasstitle" for="Ville"><i class="chess rook teal icon"></i> Ville</label>
            <% if(locals.formdata &&locals.formdata.Ville && locals.flash.code!="villeIntrouvable" ){ %>
            <input class="showsend changer" type="text" name="Ville" id="Ville"
                value="<%= locals.formdata.Ville %>"></input>
            <% }else{ %>
            <input class="showsend changer" type="text" name="Ville" id="Ville"></input>
            <% } %>
        </div>
        <div class="field unhide" hidden>
            <label class="whiteclasstitle" for="CodePostal"><i class="address card outline teal icon"></i> Code
                Postal</label>
            <% if(locals.formdata &&locals.formdata.CodePostal  && locals.flash.code!="villeIntrouvable" ){ %>
            <input class="showsend changer" name="CodePostal" id="CodePostal" value="<%= locals.formdata.CodePostal %>"
                maxlength="5"></input>
            <% }else{ %>
            <input class="showsend changer" name="CodePostal" id="CodePostal" maxlength="5"></input>
            <% } %>
        </div>
    </div>
    <div id="updformcontrol">
        <button id="inscriptionSubmit" class="ui teal labeled icon submit button formloading "><i class="icon edit"
                hidden></i>Envoyer</button></div>
    <div class="ui error message" id="imoderror"></div>

</form>
<br>
<div class=" ui form centered hiddeniformdiv" id="ajaxEmailForm" style="margin-left: 60px;">
    <div class="two fields">
        <div class="field">
            <label class="whiteclasstitle" for="ajaxEmail"> <i class="envelope teal outline icon"></i> Changez votre
                E-mail</label>
            <input id="ajaxInput" type="text" name="ajaxEmail">
        </div>
        <div class="field">


        </div>

    </div>
    <div class="two fields">
        <div class="field">
                <div id="ajaxSubmit" class="ui teal labeled icon submit button"><i class="icon envelope"
                    ></i>Valider!</div>
              
                <div class="ui error message" id="ajaxErrorDiv"></div>
                <div class="ui success message" id="ajaxSuccessDiv"></div>
        </div>
        <div class="field">
               
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        function validateEmail(email) {
            var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        }
        $('#ajaxSubmit').click(function () {
            if (validateEmail($('#ajaxInput').val())) {
                $('#ajaxEmailForm').addClass('loading')
                $('#ajaxErrorDiv').hide()
                $('#ajaxErrorDiv').text('')

                $.ajax({
                    url: '/emailupd',
                    type: 'POST',
                    dataType: 'json',
                    data: { NewMail: $('#ajaxInput').val(), Email: $('#Email').val() },
                    success: function (data) {
                        $('#ajaxEmailForm').removeClass('loading')
                        $('#ajaxInput').hide()
                        $('#ajaxSubmit')
                        $('#ajaxSuccessDiv').show()
                        $('#ajaxSuccessDiv').text('Success! Vous allez re√ßevoir une e-mail de confirmation...')

                    },
                    error: function (err) {

                        $('#ajaxEmailForm').removeClass('loading')
                        $('#ajaxErrorDiv').show()
                        $('#ajaxErrorDiv').text('Erreur! Impossible de changer votre e-mail veuillez contacter un webmaster...')

                    }
                })
            }
            else {
                $('#ajaxEmailForm').removeClass('loading')
                $('#ajaxErrorDiv').show()
                $('#ajaxErrorDiv').text('Erreur! Veuillez entrer un email valide....')
            }
        })
        $('#imod').keypress(function (e) {
            if (e.which == 13) {
                if ($('#imod').form('is valid')) {
                    $('#imod').addClass('loading')
                }
                else {
                    $('#imod').removeClass('loading')
                }
            }

        })
        $('.formloading').click(function () {

            if ($('#imod').form('is valid')) {
                $('#imod').addClass('loading')
            }
            else {
                $('#imod').removeClass('loading')
            }


        })
    })
</script>